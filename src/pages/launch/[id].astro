---
import type { GetStaticPaths } from 'astro';
import Layout from '../../layouts/Layout.astro';
import { getLaunchById, getLatestLaunches } from '../../services/spacex';
import type { Doc } from '../../types/api';

const { id } = Astro.params;

let launch: Doc;
if (id) {
  launch = await getLaunchById(id);
}

export const getStaticPaths = (async() => {
  // Call API to know how many pages to generate
  const latestLaunches = await getLatestLaunches();
  return  latestLaunches.map(launch => ({
    params: { id: launch.id }
  }));
}) satisfies GetStaticPaths;
---

<Layout title={`Launch #${id}`}>
  <article>
    { id }
  </article>
</Layout>